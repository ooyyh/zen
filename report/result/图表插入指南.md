# Zen 系统 - 图表插入和最终完成指南

## 📊 图表生成步骤

### 方法一：在线生成（推荐，无需安装）

1. **访问PlantUML在线编辑器**
   - 网址：http://www.plantuml.com/plantuml/
   - 或国内镜像：http://plantuml.jrtec.cn/

2. **逐个复制.puml文件内容**
   - 打开 `d:/Project/IdeaProjects/zen/report/template/charts/` 目录
   - 每个文件都是一个图表源代码

3. **生成PNG图片**
   ```
   1. 打开http://www.plantuml.com/plantuml/
   2. 将.puml文件内容粘贴到左侧编辑框
   3. 点击生成按钮（通常自动生成）
   4. 右侧看到图表后，右键 → 另存为 → 保存为PNG
   ```

4. **整理文件**
   - 创建一个文件夹：`d:/Project/IdeaProjects/zen/report/result/images/`
   - 将生成的PNG图片保存到这个文件夹
   - 命名方式：与原.puml文件相同，如 `01_System_Architecture.png`

### 方法二：本地生成（需要安装）

```bash
# 1. 安装PlantUML
# Windows: 下载 https://plantuml.com/download
# 或使用WSL: apt-get install plantuml

# 2. 生成所有图表
cd d:/Project/IdeaProjects/zen/report/template/charts/
plantuml -tpng *.puml

# 生成的PNG文件会在同目录下
```

## 📝 在Word中插入图表

### 步骤：

1. **打开Word文档**
   - 打开生成的Word论文文档

2. **找到图表占位符**
   - 搜索：`[系统架构图.puml]`
   - 你会找到所有需要插入的位置

3. **插入图片**
   - 选中占位符文字
   - 删除占位符
   - 菜单：插入 → 图片 → 选择对应的PNG文件
   - 调整大小至合适（推荐宽度12-15厘米）

4. **添加图表标题**
   - 在图表下添加：`图 3-1 系统架构图`（根据章节调整编号）
   - 格式：居中，小五号字体

## 📌 所有图表清单和位置

### 论文中需要插入的图表

| 序号 | 图表文件 | 论文章节 | 占位符 | 文档位置 |
|-----|---------|--------|--------|---------|
| 1 | 01_System_Architecture.puml | 3.1 | [系统架构图.puml] | 第3.1节 |
| 2 | 02_Functional_Modules.puml | 3.2 | [功能模块图.puml] | 第3.2节 |
| 3 | 03_Database_ER.puml | 3.3 | [数据库ER图.puml] | 第3.3节 |
| 4 | 04_User_Roles_Permissions.puml | 3.4 | [用户角色权限图.puml] | 第3.4节 |
| 5 | 05_Business_Process_Sequence.puml | 4.1.3 | （分布式锁流程）| 第4.1.3节 |
| 6 | 06_Frontend_Page_Structure.puml | 5.2 | [前端页面结构图.puml] | 第5.2节 |
| 7 | 07_API_Interface_Design.puml | 6.4 | [API接口设计图.puml] | 第6.4节 |
| 8 | 08_Technical_Architecture_Layers.puml | - | 技术方案文档 | 技术方案第4节 |
| 9 | 09_Deployment_Architecture.puml | 8.1 | [部署架构图.puml] | 第8.1节 |

## 🎨 Word文档最终调整

### 页面设置

1. **纸张大小**：A4
2. **边距**：
   - 上：2.54cm
   - 下：2.54cm
   - 左：3.17cm
   - 右：3.17cm
3. **行距**：1.5倍或两倍
4. **段落间距**：段前0pt，段后6-12pt

### 字体设置

- **中文字体**：宋体或仿宋体
- **英文字体**：Times New Roman
- **标题**：黑体，14-18号
- **正文**：12号
- **代码**：Courier New，10-11号

### 页码设置

1. 插入 → 页码 → 选择位置（通常右下角）
2. 设置首页不显示页码（如需要）
3. 格式：第 1 页/共 XX 页（可选）

### 目录生成

1. 光标放在目录位置
2. 引用 → 目录 → 选择风格
3. 更新目录（最后一步，在所有内容完成后）

## ✅ 最终检查清单

完成以下项目后，论文即可提交：

- [ ] 所有9个图表已生成为PNG格式
- [ ] 所有图表已插入到Word文档对应位置
- [ ] 所有占位符 `[图表名.puml]` 已替换为实际图片
- [ ] 学生基本信息已填写（姓名、学号、班级）
- [ ] 指导教师信息已填写
- [ ] 时间日期已更新
- [ ] 所有章节标题和内容已检查无误
- [ ] 图表清晰度符合要求（分辨率至少150dpi）
- [ ] 引用格式正确（参考文献）
- [ ] 代码片段格式正确（等宽字体、缩进）
- [ ] 全文拼写检查（中文）
- [ ] 页码和目录已生成并正确
- [ ] 纸张大小和边距符合要求
- [ ] 字体和排版一致
- [ ] PDF转换测试（用Adobe或在线工具）

## 🔧 常见问题解决

### Q1: PlantUML图表生成失败

**A:** 检查以下几点：
1. 代码语法是否正确（检查括号、分号）
2. 中文字符编码（应为UTF-8）
3. 网络连接是否正常
4. 尝试不同的在线工具

### Q2: 图表在Word中显示不清楚

**A:**
1. 生成时选择高分辨率（300dpi）
2. 图片不要过度缩小
3. 尝试转换为矢量格式SVG后转为EPS

### Q3: Word中文显示乱码

**A:**
1. 保存时选择UTF-8编码
2. 使用兼容性较好的字体（宋体）
3. 重新保存为.docx格式

### Q4: 图表插入后打破了文本流

**A:**
1. 选中图片 → 右键 → 换行 → 选择"衬于文字下方"或"浮于文字上方"
2. 或使用"与文字相同行"确保不破坏排版

## 📚 参考资源

- PlantUML官网：https://plantuml.com/
- PlantUML语法文档：https://plantuml.com/zh/guide
- Word排版指南：https://support.microsoft.com/zh-cn/word

## 📦 文档交付形式

最终可以提交以下格式：
- **原始格式**：.docx（Word格式，可编辑）
- **PDF格式**：.pdf（打印友好，不可编辑）
- **压缩包**：包含Word、PDF和所有图表文件

## 🎯 预期完成时间

根据你的情况估算：
- 生成图表：1-2小时
- 插入图表：1小时
- 完善内容：2-4小时
- 最后审查：1小时
- **总计**：约5-8小时

---

**温馨提示**：
1. 建议备份原始文件
2. 每次修改后都保存
3. 在最终提交前转换为PDF测试
4. 建议找师兄师姐或指导教师审阅后再提交

祝论文完成顺利！ 🎉
