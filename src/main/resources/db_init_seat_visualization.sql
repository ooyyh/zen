-- 完整的座位可视化功能SQL初始化脚本
-- 运行此脚本前请确保已运行 db_migration_add_study_room_seat_reservation.sql

-- 1. 检查并添加座位坐标字段
ALTER TABLE seat 
ADD COLUMN IF NOT EXISTS position_x INT COMMENT '座位X坐标（Canvas坐标）',
ADD COLUMN IF NOT EXISTS position_y INT COMMENT '座位Y坐标（Canvas坐标）';

-- 2. 为现有座位添加默认坐标（如果有数据）
UPDATE seat 
SET position_x = 100, position_y = 100 
WHERE position_x IS NULL;

-- 3. 测试数据：为第一自习室生成带坐标的座位（如果表为空）
-- 可以删除原有测试数据重新生成
DELETE FROM seat WHERE study_room_id = 1;

-- 生成5行10列的网格座位
INSERT INTO seat (study_room_id, seat_no, seat_type, has_power, position_x, position_y) VALUES
-- 第1行
(1, 'A01-01', '单人', 1, 50, 50),
(1, 'A01-02', '单人', 1, 100, 50),
(1, 'A01-03', '单人', 0, 150, 50),
(1, 'A01-04', '单人', 0, 200, 50),
(1, 'A01-05', '单人', 1, 250, 50),
(1, 'A01-06', '单人', 1, 300, 50),
(1, 'A01-07', '单人', 0, 350, 50),
(1, 'A01-08', '单人', 0, 400, 50),
(1, 'A01-09', '单人', 1, 450, 50),
(1, 'A01-10', '单人', 0, 500, 50),
-- 第2行
(1, 'A02-01', '单人', 1, 50, 100),
(1, 'A02-02', '单人', 1, 100, 100),
(1, 'A02-03', '单人', 0, 150, 100),
(1, 'A02-04', '单人', 0, 200, 100),
(1, 'A02-05', '单人', 1, 250, 100),
(1, 'A02-06', '单人', 1, 300, 100),
(1, 'A02-07', '单人', 0, 350, 100),
(1, 'A02-08', '单人', 0, 400, 100),
(1, 'A02-09', '单人', 1, 450, 100),
(1, 'A02-10', '单人', 0, 500, 100),
-- 第3行
(1, 'A03-01', '单人', 1, 50, 150),
(1, 'A03-02', '单人', 1, 100, 150),
(1, 'A03-03', '单人', 0, 150, 150),
(1, 'A03-04', '单人', 0, 200, 150),
(1, 'A03-05', '单人', 1, 250, 150),
(1, 'A03-06', '单人', 1, 300, 150),
(1, 'A03-07', '单人', 0, 350, 150),
(1, 'A03-08', '单人', 0, 400, 150),
(1, 'A03-09', '单人', 1, 450, 150),
(1, 'A03-10', '单人', 0, 500, 150),
-- 第4行
(1, 'A04-01', '单人', 1, 50, 200),
(1, 'A04-02', '单人', 1, 100, 200),
(1, 'A04-03', '单人', 0, 150, 200),
(1, 'A04-04', '单人', 0, 200, 200),
(1, 'A04-05', '单人', 1, 250, 200),
(1, 'A04-06', '单人', 1, 300, 200),
(1, 'A04-07', '单人', 0, 350, 200),
(1, 'A04-08', '单人', 0, 400, 200),
(1, 'A04-09', '单人', 1, 450, 200),
(1, 'A04-10', '单人', 0, 500, 200),
-- 第5行
(1, 'A05-01', '单人', 1, 50, 250),
(1, 'A05-02', '单人', 1, 100, 250),
(1, 'A05-03', '单人', 0, 150, 250),
(1, 'A05-04', '单人', 0, 200, 250),
(1, 'A05-05', '单人', 1, 250, 250),
(1, 'A05-06', '单人', 1, 300, 250),
(1, 'A05-07', '单人', 0, 350, 250),
(1, 'A05-08', '单人', 0, 400, 250),
(1, 'A05-09', '单人', 1, 450, 250),
(1, 'A05-10', '单人', 0, 500, 250);

-- 验证数据
SELECT COUNT(*) as total_seats FROM seat WHERE study_room_id = 1;
SELECT * FROM seat WHERE study_room_id = 1 LIMIT 5;
